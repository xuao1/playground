Running iteration 1 with 0.6...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=10, simu_ts_len=500, real_run=True, enable_recompute=False, mode='ours', req_interval=0.1362, model='diffusion_cnn', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=3, verbose=0, config='./config_ours.yaml', diffusion_step=100, diffusion_stage_num=5, input_img_num=4, input_img_size=84, input_traj_cnn_size=16, input_traj_transformer_size=10, input_cond_size=274, input_dim=20, cond_dim=274, n_emb=768, global_cond_dim=548, perception_scale=0.6, generation_scale=0.6)
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
('e',): 1
('p', 'e'): 1
('d', 'p', 'e'): 1
('d', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 489
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
(0,): 1
(1, 0): 1
(2, 1, 0): 1
(3, 2, 1, 0): 1
(4, 3, 2, 1, 0): 1
(5, 4, 3, 2, 1, 0): 1
(6, 5, 4, 3, 2, 1, 0): 1
(7, 6, 5, 4, 3, 2, 1, 0): 1
(8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 489
Start DiffusionPolicy inference...
data_type:  torch.bfloat16
Perception params: 1.168951e+07
Generation params: 2.635040e+08
====== Graph for resnet generated ======
====== Graph for backbone generated ======
Duration of graphs:  149.32275390625
Frame interval: 0.1500 s
Throughput: 6.667
DiffusionPolicy inference finished.
Iteration 1 completed.
--------------------------------------
Running iteration 2 with 0.6...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=10, simu_ts_len=500, real_run=True, enable_recompute=False, mode='ours', req_interval=0.1362, model='diffusion_cnn', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=3, verbose=0, config='./config_ours.yaml', diffusion_step=100, diffusion_stage_num=5, input_img_num=4, input_img_size=84, input_traj_cnn_size=16, input_traj_transformer_size=10, input_cond_size=274, input_dim=20, cond_dim=274, n_emb=768, global_cond_dim=548, perception_scale=0.6, generation_scale=0.6)
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
('e',): 1
('p', 'e'): 1
('d', 'p', 'e'): 1
('d', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 489
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
(0,): 1
(1, 0): 1
(2, 1, 0): 1
(3, 2, 1, 0): 1
(4, 3, 2, 1, 0): 1
(5, 4, 3, 2, 1, 0): 1
(6, 5, 4, 3, 2, 1, 0): 1
(7, 6, 5, 4, 3, 2, 1, 0): 1
(8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 489
Start DiffusionPolicy inference...
data_type:  torch.bfloat16
Perception params: 1.168951e+07
Generation params: 2.635040e+08
====== Graph for resnet generated ======
====== Graph for backbone generated ======
Duration of graphs:  150.0675506591797
Frame interval: 0.1502 s
Throughput: 6.660
DiffusionPolicy inference finished.
Iteration 2 completed.
--------------------------------------
Running iteration 3 with 0.6...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=10, simu_ts_len=500, real_run=True, enable_recompute=False, mode='ours', req_interval=0.1362, model='diffusion_cnn', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=3, verbose=0, config='./config_ours.yaml', diffusion_step=100, diffusion_stage_num=5, input_img_num=4, input_img_size=84, input_traj_cnn_size=16, input_traj_transformer_size=10, input_cond_size=274, input_dim=20, cond_dim=274, n_emb=768, global_cond_dim=548, perception_scale=0.6, generation_scale=0.6)
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
('e',): 1
('p', 'e'): 1
('d', 'p', 'e'): 1
('d', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 489
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
(0,): 1
(1, 0): 1
(2, 1, 0): 1
(3, 2, 1, 0): 1
(4, 3, 2, 1, 0): 1
(5, 4, 3, 2, 1, 0): 1
(6, 5, 4, 3, 2, 1, 0): 1
(7, 6, 5, 4, 3, 2, 1, 0): 1
(8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 489
Start DiffusionPolicy inference...
data_type:  torch.bfloat16
Perception params: 1.168951e+07
Generation params: 2.635040e+08
====== Graph for resnet generated ======
====== Graph for backbone generated ======
Duration of graphs:  151.0704345703125
Frame interval: 0.1502 s
Throughput: 6.657
DiffusionPolicy inference finished.
Iteration 3 completed.
--------------------------------------
Running iteration 4 with 0.6...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=10, simu_ts_len=500, real_run=True, enable_recompute=False, mode='ours', req_interval=0.1362, model='diffusion_cnn', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=3, verbose=0, config='./config_ours.yaml', diffusion_step=100, diffusion_stage_num=5, input_img_num=4, input_img_size=84, input_traj_cnn_size=16, input_traj_transformer_size=10, input_cond_size=274, input_dim=20, cond_dim=274, n_emb=768, global_cond_dim=548, perception_scale=0.6, generation_scale=0.6)
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
('e',): 1
('p', 'e'): 1
('d', 'p', 'e'): 1
('d', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 489
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
(0,): 1
(1, 0): 1
(2, 1, 0): 1
(3, 2, 1, 0): 1
(4, 3, 2, 1, 0): 1
(5, 4, 3, 2, 1, 0): 1
(6, 5, 4, 3, 2, 1, 0): 1
(7, 6, 5, 4, 3, 2, 1, 0): 1
(8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 489
Start DiffusionPolicy inference...
data_type:  torch.bfloat16
Perception params: 1.168951e+07
Generation params: 2.635040e+08
====== Graph for resnet generated ======
====== Graph for backbone generated ======
Duration of graphs:  150.47885131835938
Frame interval: 0.1501 s
Throughput: 6.664
DiffusionPolicy inference finished.
Iteration 4 completed.
--------------------------------------
Running iteration 5 with 0.6...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=10, simu_ts_len=500, real_run=True, enable_recompute=False, mode='ours', req_interval=0.1362, model='diffusion_cnn', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=3, verbose=0, config='./config_ours.yaml', diffusion_step=100, diffusion_stage_num=5, input_img_num=4, input_img_size=84, input_traj_cnn_size=16, input_traj_transformer_size=10, input_cond_size=274, input_dim=20, cond_dim=274, n_emb=768, global_cond_dim=548, perception_scale=0.6, generation_scale=0.6)
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
('e',): 1
('p', 'e'): 1
('d', 'p', 'e'): 1
('d', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 1
('d', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'p', 'e'): 489
['e', 'p', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd', 'd']
12
---------
(0,): 1
(1, 0): 1
(2, 1, 0): 1
(3, 2, 1, 0): 1
(4, 3, 2, 1, 0): 1
(5, 4, 3, 2, 1, 0): 1
(6, 5, 4, 3, 2, 1, 0): 1
(7, 6, 5, 4, 3, 2, 1, 0): 1
(8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 1
(11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0): 489
Start DiffusionPolicy inference...
data_type:  torch.bfloat16
Perception params: 1.168951e+07
Generation params: 2.635040e+08
====== Graph for resnet generated ======
====== Graph for backbone generated ======
Duration of graphs:  150.98471069335938
Frame interval: 0.1501 s
Throughput: 6.662
DiffusionPolicy inference finished.
Iteration 5 completed.
--------------------------------------
All iterations are complete. Output saved to diffusion_cnn_0.6_ours.log.
Average Query Duration: 0.15012 s (0.15012000 seconds)
Throughput: 6.66133759 requests/second
