Testing with worker_num=2
Running iteration 1 with worker_num=2...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/usr/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=6, simu_ts_len=500, real_run=True, enable_recompute=False, mode='parallel_v2', req_interval=0.0584, model='openvla', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=2, verbose=0, config='./config_parallel.yaml', diffusion_step=100, diffusion_stage_num=5)
Start OpenVLA inference...
self.n_replica:  2
====== Graph for prefill generated ======
====== Graph for decode generated ======
====== Graph for DINOv2 generated ======
====== Graph for SigLIP generated ======
Query latency: 3078.080 ms
Query duration: 132.432
Throughput: 7.551
OpenVLA inference finished.
Iteration 1 completed.
--------------------------------------
Running iteration 2 with worker_num=2...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/usr/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=6, simu_ts_len=500, real_run=True, enable_recompute=False, mode='parallel_v2', req_interval=0.0584, model='openvla', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=2, verbose=0, config='./config_parallel.yaml', diffusion_step=100, diffusion_stage_num=5)
Start OpenVLA inference...
self.n_replica:  2
====== Graph for prefill generated ======
====== Graph for decode generated ======
====== Graph for DINOv2 generated ======
====== Graph for SigLIP generated ======
Query latency: 3258.487 ms
Query duration: 132.916
Throughput: 7.524
OpenVLA inference finished.
Iteration 2 completed.
--------------------------------------
Running iteration 3 with worker_num=2...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/usr/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=6, simu_ts_len=500, real_run=True, enable_recompute=False, mode='parallel_v2', req_interval=0.0584, model='openvla', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=2, verbose=0, config='./config_parallel.yaml', diffusion_step=100, diffusion_stage_num=5)
Start OpenVLA inference...
self.n_replica:  2
====== Graph for prefill generated ======
====== Graph for decode generated ======
====== Graph for DINOv2 generated ======
====== Graph for SigLIP generated ======
Query latency: 3280.698 ms
Query duration: 132.851
Throughput: 7.527
OpenVLA inference finished.
Iteration 3 completed.
--------------------------------------
Running iteration 4 with worker_num=2...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/usr/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=6, simu_ts_len=500, real_run=True, enable_recompute=False, mode='parallel_v2', req_interval=0.0584, model='openvla', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=2, verbose=0, config='./config_parallel.yaml', diffusion_step=100, diffusion_stage_num=5)
Start OpenVLA inference...
self.n_replica:  2
====== Graph for prefill generated ======
====== Graph for decode generated ======
====== Graph for DINOv2 generated ======
====== Graph for SigLIP generated ======
Query latency: 3225.617 ms
Query duration: 132.871
Throughput: 7.526
OpenVLA inference finished.
Iteration 4 completed.
--------------------------------------
Running iteration 5 with worker_num=2...
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:439: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/workspace/xformers/playground/../../repos/x-transformers/x_transformers/x_transformers.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled = False)
/usr/lib/python3.10/contextlib.py:103: FutureWarning: `torch.backends.cuda.sdp_kernel()` is deprecated. In the future, this context manager will be removed. Please see `torch.nn.attention.sdpa_kernel()` for the new context manager, with updated signature.
  self.gen = func(*args, **kwds)
Namespace(query_interval=1, input_seq_len=8, encoder_n=1, prefill_n=1, decode_n=1, encoder_len=1, prefill_len=1, decode_len=6, simu_ts_len=500, real_run=True, enable_recompute=False, mode='parallel_v2', req_interval=0.0584, model='openvla', dim=512, enable_slice=False, warmup_num=10, trail_num=20, profile_mode='flashinfer', only_profile=False, num_trails=200, worker_num=2, verbose=0, config='./config_parallel.yaml', diffusion_step=100, diffusion_stage_num=5)
Start OpenVLA inference...
self.n_replica:  2
====== Graph for prefill generated ======
====== Graph for decode generated ======
====== Graph for DINOv2 generated ======
====== Graph for SigLIP generated ======
Query latency: 3116.649 ms
Query duration: 132.679
Throughput: 7.537
OpenVLA inference finished.
Iteration 5 completed.
--------------------------------------
All iterations for worker_num=2 are complete. Output saved to openvla_parallel_worker2.log.
Average Query Duration: 132.75 ms (0.13275000 seconds)
Throughput: 7.53295668 requests/second
====================================
